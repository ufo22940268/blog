title: 关于 ui 测试
date: 2016-03-20 19:42:57
tags: test
---

我一直是一个对自动化测试非常着迷的人.在刚开始进入工作的的时候,就非常认同Bent大神说的: `在开始写代码前,一定要先写好测试用例`, `有了测试用例,就能够很清楚下一步该怎么走`, `我现在已经开始教女儿 TDD了`.   

可是我的第一份工作负责的内容就是Android porting, 而且偏偏移植的是Framework层的内容.那时候天真的我就开始各种用`performClick`来模拟界面的点击, 用`instrument`来启动我想测试的`activity`进行测试.不仅每次运行测试用例极慢,而且特别难维护.
再后来,我又先后尝试了`robot`, `roboletric`, `espresso`等等 Android 测试框架但是都没能打到理想的代码覆盖度.再后来,我就开始转型做后端了.后端的测试倒是能做到全覆盖.

所以直到现在,我还是在思考,如何做 ui 的测试.

-------------------

不过今天,我看到一个[视频](https://youtu.be/qqVbr_LaCIo?t=2m15s)给我非常大的启示.

演讲者Pete Hunt在视频里面对 UI 开发的描述是

> Don't try to be correct.
> Try to be predictable.

然后他接下来说了,关于UI开发的难点就在于各种 UI 模型中的状态实在太多了,然后很多状态都是可变的.所以我们应该通过下面几种方法来做到`predictable`

- 尽量统一 state,不让一个 state 存在多个地方.
- 用类似于[Immunity.js]()之类的项目, 来减少赋值.
- 用各种方法让UI的变化可跟踪.
- 组件化开发.
